par(mfrow=c(2,2), mar=c(2,1,2,2))
for(i in 1:4){
plot(t1, df[,i], ylab=paste0("[I_3] run ",i), main=paste("Run", i))
lm(time~df[,i])
}
par(mfrow=c(2,2), mar=c(2,2,1,2))
for(i in 1:4){
plot(t1, df[,i], ylab=paste0("[I_3] run ",i), main=paste("Run", i))
lm(time~df[,i])
}
par(mfrow=c(2,2), mar=c(3,2,1,2))
for(i in 1:4){
plot(t1, df[,i], ylab=paste0("[I_3] run ",i), main=paste("Run", i))
lm(time~df[,i])
}
par(mfrow=c(2,2), mar=c(3,3,1,2))
for(i in 1:4){
plot(time, df[,i], ylab=paste0("[I_3] run ",i), main=paste("Run", i))
lm(time~df[,i])
}
par(mfrow=c(2,2), mar=c(3,3,3,2))
for(i in 1:4){
plot(time, df[,i], ylab=paste0("[I_3] run ",i), main=paste("Run", i))
lm(time~df[,i])
}
par(mfrow=c(2,2), mar=c(4,3,1,2))
for(i in 1:4){
plot(time, df[,i], ylab=paste0("[I_3] run ",i), main=paste("Run", i))
lm(time~df[,i])
}
par(mfrow=c(2,2), mar=c(4,4,1,2))
for(i in 1:4){
plot(time, df[,i], ylab=paste0("[I_3] run ",i), main=paste("Run", i))
lm(time~df[,i])
}
for(i in 1:4){
plot(time, df[,i], ylab="[I_3]", main=paste("Run", i))
lm(time~df[,i])
}
df=data.frame(I1=Abs1,I2=Abs2, I3=Abs3, I4=Abs4)/89
par(mfrow=c(2,2), mar=c(4,4,1,2))
for(i in 1:4){
plot(time, df[,i], ylab="[I_3]", main=paste("Run", i))
print(lm(time~df[,i]))
}
df
df=data.frame(I1=Abs1,I2=Abs2, I3=Abs3, I4=Abs4)/89
par(mfrow=c(2,2), mar=c(4,4,1,2))
for(i in 1:4){
plot(time, df[,i], ylab="[I_3]", main=paste("Run", i))
print(lm(df[,i]~time))
}
-9.771e-07/-1.720e-06
-9.771e-07/-1.710e-06
0.0545/0.0909
0.682/1.136
-9.771e-07/0.0545
Abs1/89
0.003505618/30
(0.003505618-0.003483146)/30
(0.003449438-0.003505618)/(182-151)
x=(15^2/(9.8*50))
atan(x)
r=atan(x)
r*180/(2*pi)
tan(r)
tan(r)
tan(r)
y=50*9.8*(sin(r)-tan(r))/cos(r)
y
y=(50*9.8*(sin(r)-tan(r)))/cos(r)
y
sin(r)
tan(r)
1/tan(r)
0.46/tan(r)
y=(50*9.8*(sin(r)-tan(r)))/cos(r)
y
sqrt(-y)
t=c(0,9, 18, 27, 40, 54, 72, 105, 135)
C=c(0.1056, 0.0961, 0.0856, 0.0767 ,0.0645 ,0.0536 0.0432, 0.0270, 0.0174)
C=c(0.1056, 0.0961, 0.0856, 0.0767 ,0.0645 ,00536 0.0432, 0.0270, 0.0174)
0.1056
0.0961
C=c(0.1056, 0.0961, 0.0856, 0.0767,0.0645 ,00536, 0.0432, 0.0270, 0.0174)
t=c(0,9, 18, 27, 40, 54, 72, 105, 135)
C=c(0.1056, 0.0961, 0.0856, 0.0767,0.0645 ,00536, 0.0432, 0.0270, 0.0174)
plot(c,t)
plot(C,t)
t=c(0,9, 18, 27, 40, 54, 72, 105, 135)
C=c(0.1056, 0.0961, 0.0856, 0.0767,0.0645 ,00536, 0.0432, 0.0270, 0.0174)
plot(C,t)
par(mfrow=c(1,1))
plot(C,t)
plot(t,c)
plot(t,C)
C
t=c(0,9, 18, 27, 40, 54, 72, 105, 135)
C=c(0.1056, 0.0961, 0.0856, 0.0767,0.0645 ,0.0536, 0.0432, 0.0270, 0.0174)
par(mfrow=c(1,1))
plot(t,C)
t=c(0,9, 18, 27, 40, 54, 72, 105, 135)
C=c(0.1056, 0.0961, 0.0856, 0.0767,0.0645 ,0.0536, 0.0432, 0.0270, 0.0174)
par(mfrow=c(1,2))
plot(t,C)
plot(t, 1/C)
t=c(0,9, 18, 27, 40, 54, 72, 105, 135)
C=c(0.1056, 0.0961, 0.0856, 0.0767,0.0645 ,0.0536, 0.0432, 0.0270, 0.0174)
par(mfrow=c(1,2))
plot(t,C)
plot(t, log(C))
t=c(0,2,4,6,8,10)
M=c(0.01, 0.0071, 0.0055, 0.0045, 0.0038, 0.0033)
plot(t,M)
par(mfrow=c(1,1))
t=c(0,2,4,6,8,10)
M=c(0.01, 0.0071, 0.0055, 0.0045, 0.0038, 0.0033)
plot(t,M)
plot(t,M, xlab="time", ylab="[NOBr]")
par(mfrow=c(1,1))
plot(t,M, xlab="time", ylab="[NOBr]")
plot(t,M, xlab="time", ylab="[NOBr]", main="Plot of [NOBr] vs Time")
par(mfrow=c(1,1))
plot(t,M, xlab="time", ylab="[NOBr]", main="Plot of [NOBr] vs Time")
t=c(0 ,300, 600, 1200 ,1800 ,3000 ,5400)
br=c(0.0505, 0.0466, 0.0432, 0.0379, 0.0338, 0.0275, 0.0202)
o=c(0.0505 ,0.0467, 0.0432, 0.0379, 0.0336, 0.0274, 0.0203)
plot(br, t)
plot(1/br, t)
plot(t, 1/br)
plot(t, o)
plot(t, 1/o)
par(mfrow=c(2,2))
plto(t, br)
par(mfrow=c(2,2))
plot(t, br)
plot(t, 1/br)
plot(t, o)
plot(t, 1/o)
par(mfrow=c(2,3))
plot(t, br)
plot(t, log(br))
plot(t, 1/br)
plot(t, log(o))
plot(t, o)
plot(t, 1/o)
50*9.8*(4.6*cos(th)+sin(th))/(cos(th)+4.6*sin(th))
th=24.66*2*3.14/180
th
50*9.8*(4.6*cos(th)+sin(th))/(cos(th)+4.6*sin(th))
sqrt(444.8645)
h=-53.3-110
tot=c(632, 618.5, 599.4, 584.2, 567.3, 546.8, 527.8,
509.3)
2*p0-tot
p0=632
2*p0-tot
tot
2*p0
tot-p0
tot*2/3
p0-tot
2*p0-tot
2*p0-tot
p0-tot/6
2*p0-tot/3
(p0/2)-tot/6
p0-tot/6
p0-tot
2*p0-tot
2*p0-3*tot
1.5*p0-0.5*tot
tot-0.3p0
tot-0.5*p0
(tot-0.5*p0)*2
PA+(tot-0.5*p0)*2
PA=(tot-0.5*p0)*2
time=c(632, 618.5, 599.4, 584.2, 567.3, 546.8,
527.8, 509.3)
plot(time, PA)
time=c(0, 3.25, 8.02, 12.18, 17.30, 24.55, 33.00, 42.50)
plot(time, PA)
plot(1/time, 1/PA)
plot(time, PA)
plot(time, 1/PA)
plot(time, log(PA))
lm(time, 1/PA)
lm(time~1/PA)
lm(time~ log(PA))
summary(lm(time~1/PA))
summary(lm(time~ log(PA)))
y=log(PA)
x=1/PA
summary(lm(time~x))
summary(lm(time~ y))
plot(lm(time~x))
plot(lm(time~ y))
plot(lm(time~x))
plot(time, 1/PA)
plot(time, log(PA))
plot(time, log(PA), main='First Order')
plot(time, 1/PA, main='Second Order')
par(mfrow=c(1,2))
plot(time, log(PA), main='First Order')
plot(time, 1/PA, main='Second Order')
mod2=lm(time~x)
mod1=plot(lm(time~ y))
mod2=lm(time~x)
mod1=lm(time~ y)
mod1$coefficients
par(mfrow=c(1,2))
plot(time, log(PA), main='First Order')
abline(mod1$coefficients[1],mod1$coefficients[1] )
abline(mod1$coefficients[1],mod1$coefficients[2] )
abline(mod1$coefficients[2],mod1$coefficients[1] )
mod1$coefficients[2]
mod1$coefficients[1]
mod1
?abline
abline(coef=mod1$coefficients)
plot(time, log(PA), main='First Order')
par(mfrow=c(1,2))
plot(time, log(PA), main='First Order')
abline(coef=mod1$coefficients)
mod1$coefficients
mod2=lm(x~time)
mod1=lm(y~time)
par(mfrow=c(1,2))
plot(time, log(PA), main='First Order')
abline(coef=mod1$coefficients)
plot(time, 1/PA, main='Second Order')
abline(coef=mod2$coefficients)
mod2
t=c(15, 25, 35, 45)
k=c(0.0521, 0.101, 0.184, 0.332)
plot(log(k), 1/t)
plot( 1/t,log(k))
par(mfrow=c(1,1))
plot( 1/t,log(k))
log(0.101/0.0521)/((1/(273+25))-(1/(273+15)))*-8.3144598
(log(0.101/0.0521)/((1/(273+25))-(1/(273+15))))*-8.3144598
mod2$coefficients
mod2$coefficients/2
0.101/(exp(-47235.84/(8.3144598*(273+25))))
0.101/(exp(-47.23584/(0.001*8.3144598*(273+25))))
plot( 1/t,log(k))
t=c(15, 25, 35, 45)+273
k=c(0.0521, 0.101, 0.184, 0.332)
par(mfrow=c(1,1))
plot( 1/t,log(k))
mod3=lm(kk~tt)
par(mfrow=c(1,1))
plot( 1/t,log(k))
tt=1/t
kk=log(k)
mod3=lm(kk~tt)
abline(coef=mod3$coefficients)
mod3
log(16.62)
-5638.34*8.3144598
-5638.34*8.3144598/1000
(-709-278)-(-480-230)
mod2=lm(x~time)
mod1=lm(y~time)
y=log(PA)
x=1/PA
par(mfrow=c(1,2))
plot(time, log(PA), main='First Order')
abline(coef=mod1$coefficients)
plot(time, 1/PA, main='Second Order')
abline(coef=mod2$coefficients)
t=c(15, 25, 35, 45)+273
k=c(0.0521, 0.101, 0.184, 0.332)
par(mfrow=c(1,1))
plot( 1/t,log(k))
tt=1/t
kk=log(k)
mod3=lm(kk~tt)
abline(coef=mod3$coefficients)
mod2=lm(x~time)
mod1=lm(y~time)
y=log(PA)
x=1/PA
par(mfrow=c(1,2))
plot(time, log(PA), main='First Order')
abline(coef=mod1$coefficients)
plot(time, 1/PA, main='Second Order')
abline(coef=mod2$coefficients)
T=c(15, 25, 35, 45)+273
k=c(0.0521, 0.101, 0.184, 0.332)
par(mfrow=c(1,1))
plot( 1/t,log(k), main="Problem 2a")
tt=1/t
kk=log(k)
mod3=lm(kk~tt)
abline(coef=mod3$coefficients)
T=c(15, 25, 35, 45)+273
mod2=lm(x~time)
mod1=lm(y~time)
y=log(PA)
x=1/PA
par(mfrow=c(1,2))
plot(time, log(PA), main='First Order')
abline(coef=mod1$coefficients)
plot(time, 1/PA, main='Second Order')
abline(coef=mod2$coefficients)
T=c(15, 25, 35, 45)+273
k=c(0.0521, 0.101, 0.184, 0.332)
par(mfrow=c(1,1))
plot( 1/T,log(k), main="Problem 2a")
tt=1/t
kk=log(k)
mod3=lm(kk~tt)
abline(coef=mod3$coefficients)
exp(16.62)
tot=c(632, 618.5, 599.4, 584.2, 567.3, 546.8, 527.8,
509.3)
p0=632
tot-0.5*p0
2*(tot-0.5*p0)
mod3$coefficients
-5638.34*8.3144598/1000
ln(16.62311)
log(16.62311)
sqrt(0.1)
graphics.off()
3/sqrt(0.1)
0.5*0.0027*3/(sqrt(0.1))^2
0.5*0.0027*(3/sqrt(0.1))^2
0.12+0.04+0.24
0.6^2+0.1*0.2+0.2^2
0.1/0.4
0.2/0.4
16.25*5
(130500-115700)/130500
(41.8-40.7)/41.8
6.34+11.64+16.75+71.08
6.34+11.64+16.75+(16.34*4)
6.34+(2*5.35)+16.75+(16.34*4)
16.34*4
6.34+(2*5.35)+16.75+71.08
16.34*4
6.34+(2*5.35)+16.75+65.36
2*5.35
71.08+11.64+16.75+6.34
71.08+11.64+16.38+6.34
64/12
3*64/12
setwd('bee/')
knitr::opts_chunk$set(echo = TRUE)
install.packages("qtlcharts",  repos = 'http://cran.rstudio.com/')
install.packages("qtlcharts",  repos = 'http://cran.rstudio.com/')
library(qtlcharts)
install.packages("qtlcharts")
install.packages("qtlcharts")
library(qtlcharts)
read.csv('pollinator_visitation_fullData_log.csv')
iplotCorr(mydat_small_val_log[,1:12],mydat_small_val_log$Visits, reorder=TRUE,
chartOpts=list(cortitle="Correlation matrix",
scattitle="Scatterplot | Visits",
scatcolors=c("red","#00BFFF")
))
mydat_small_val_log=read.csv('pollinator_visitation_fullData_log.csv')
iplotCorr(mydat_small_val_log[,1:12],mydat_small_val_log$Visits, reorder=TRUE,
chartOpts=list(cortitle="Correlation matrix",
scattitle="Scatterplot | Visits",
scatcolors=c("red","#00BFFF")
))
wt=c(0.9525, 0.9521, 0.9527,0.9536)-0.9484
wt
brix=c(1,1.5,1,1.5)
brix=c(1,1.5,1,1.5)/100
brix
wt_b=c(0.9525, 0.9521, 0.9527,0.9536)
wt_b*brix/wt
brix
wt_b*brix/wt
(wt_b*brix)/wt
wt_b
wt
wt+0.0001
wt=wt+0.0001
wt_b*brix/wt
brix=c(1,1.5,1,1.5)
wt_b*brix/wt
wt_b
wt
h2o=ffh-ff-t
ffh=c(1.7809,1.7536,1.8149)
ff=c(0.8290, 0.7985, 0.8491)
f=c(0.9622, 0.7646, 0.7183)
t=c(0.9252,0.9274, 0.9383)
h2o=ffh-ff-t
h2o
th=c(0.9534,0.9449,0.9556)
hn=th-t
n=hn-h2o
n
th+ffa
th=c(0.9534,0.9449,0.9556)
ffa=c(0.8335,0.8089,0.8596)
th+ffa
ffa-ff
retained=(ffa-ff)
retained/(retained+h20)
retained/(retained+h20)
retained/(retained+h2o)
h2oa=th-t
h2oa/h2o
h2oa/h2o
h2oa
h2o
retained
retained/(retained+h2o)
h2oa/h2o
retained/(retained+h2o)+h2oa/h2o
h2oa*p-h2o
p=1-retained/(retained+h2o)
h2oa*p-h2o
h2oa=th-t
retained=(ffa-ff)
retained
p
p=1-retained/(retained+h2o)
flowerb=ff-f
flowera=ffa-f
flowera
ff-f
n=retained+h2oa-h20
n=retained+h2oa-h2o
n
r=c(4.5,3,5)/100
h2oa*r/n
h2oa
r
n
h2oa
h2oa*r/n
flowerb=ff-f
flowerb
1000/60
library(reshape2)
#data formatting for further pollinator visitation analysis
#
library(reshape2)
#install.packages("devtools")
library(devtools)
#install_github("ggobi/ggally")
library(Deducer)
library(corrplot)
library(ggplot2)
library(GGally)
library(gsheet)
#install.packages('GenABEL')
library(GenABEL)
round.POSIXct <- function(x, units = c("mins", "5 mins", "10 mins", "15
mins", "quarter hours", "30 mins", "half hours", "hours")){
if(is.numeric(units)) units <- as.character(units)
units <- match.arg(units)
r <- switch(units,
"mins" = 60,
"5 mins" = 60*5,
"10 mins" = 60*10,
"15 mins"=, "quarter hours" = 60*15,
"30 mins"=, "half hours" = 60*30,
"hours" = 60*60
)
H <- as.integer(format(x, "%H"))
M <- as.integer(format(x, "%M"))
S <- as.integer(format(x, "%S"))
D <- format(x, "%Y-%m-%d")
secs <- 3600*H + 60*M + S
as.POSIXct(round(secs/r)*r, origin=D)
}
url='docs.google.com/spreadsheets/d/1LKr8Ken8p1jpTGpbn2a_napP6uNJ4sEnN8gdDSEQGxY/edit#gid=1630939193'
mydat=read.csv(text=gsheet2text(url, format='csv'))
head(mydat)
summary(mydat)
dim(mydat)
summary(mydat)
size=strsplit(as.character(nect$Location), ' ')
df=as.data.frame(t(matrix(unlist(size), 3)))
url='docs.google.com/spreadsheets/d/1LKr8Ken8p1jpTGpbn2a_napP6uNJ4sEnN8gdDSEQGxY/edit#gid=1630939193'
mydat=read.csv(text=gsheet2text(url, format='csv'))
head(mydat)
summary(mydat)
dim(mydat)
size=strsplit(as.character(mydat$Location), ' ')
df=as.data.frame(t(matrix(unlist(size), 3)))
names(df)=c('non', 'Pair', 'Size')
mydat=cbind(mydat, df[,2:3])
head(mydat)
names(mydat)
mydat$tot_flowers=mydat$Avg.open.flowers.per.inflorescenc*mydat$Total.inflorescenses
mydat_small=mydat[, c('Date', 'Experiment.Week','Location', 'Plant.Number','Pair','Size', 'Start.Time',
'End.Time', 'Avg.open.flowers.per.inflorescence', 'Total.inflorescenses', 'Honeybees')]
names(mydat)
url='docs.google.com/spreadsheets/d/1LKr8Ken8p1jpTGpbn2a_napP6uNJ4sEnN8gdDSEQGxY/edit#gid=1630939193'
mydat=read.csv(text=gsheet2text(url, format='csv'))
head(mydat)
summary(mydat)
dim(mydat)
size=strsplit(as.character(mydat$Location), ' ')
df=as.data.frame(t(matrix(unlist(size), 3)))
names(df)=c('non', 'Pair', 'Size')
mydat=cbind(mydat, df[,2:3])
head(mydat)
names(mydat)
mydat$tot_flowers=mydat$Avg.open.flowers.per.inflorescenc*mydat$Total.inflorescenses
mydat_small=mydat[, c('Date', 'Experiment.Week','Location', 'Plant.Number','Pair','Size', 'Start.Time',
'End.Time', 'Avg.open.flowers.per.inflorescence', 'Total.inflorescenses', 'Honeybees')]
names(mydat)
